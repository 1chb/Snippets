module Oil (calculateOilVolume) where

calculateOilVolume :: Double -> Double -> Double -> Double
calculateOilVolume diameter len depth = segmentArea * len
  where
    radius = diameter / 2
    theta = 2 * acos ((radius - depth) / radius)
    segmentArea = (radius ^ (2 :: Int) / 2) * (theta - sin theta)

-- >>> let d = 10 -- diameter decimeter (dm)
-- >>> let v = 3000 -- volume liter (l)
-- >>> let l = v / (d*d*pi/4) -- length
-- >>> let calc = round . calculateOilVolume d l
-- >>> (round $ d*100, round $ l*100) -- (diameter (mm), length (mm))
-- >>> [(round x, calc $ x/100) | x <- [325, 780, 745, 710, 685, 660, 635, 550, 510, 480, 430, 435, 425, 405, 375, 345, 320, 295]]
-- >>> let n = 40 -- [(x = oil depth (mm), y = oil volume (l))]
-- >>> [(round $ x*100, calc x) | k <- [0..n], let x = d*k/n]
-- (1000,3820)
-- [(325,845),(780,2511),(745,2397),(710,2278),(685,2190),(660,2101),(635,2009),(550,1691),(510,1538),(480,1424),(430,1233),(435,1252),(425,1215),(405,1139),(375,1028),(345,918),(320,828),(295,739)]
-- [(0,0),(25,20),(50,56),(75,102),(100,156),(125,216),(150,282),(175,353),(200,427),(225,505),(250,587),(275,671),(300,757),(325,845),(350,936),(375,1028),(400,1121),(425,1215),(450,1309),(475,1405),(500,1500),(525,1595),(550,1691),(575,1785),(600,1879),(625,1972),(650,2064),(675,2155),(700,2243),(725,2329),(750,2413),(775,2495),(800,2573),(825,2647),(850,2718),(875,2784),(900,2844),(925,2898),(950,2944),(975,2980),(1000,3000)]
